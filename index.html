<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>å¤šæ©Ÿèƒ½ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>ã‚«ãƒ¬ãƒ³ãƒ€ã‚¤ã‚¢ãƒªãƒ¼</h1>
    <p>äºˆå®šã¨æ—¥è¨˜ã‚’ã²ã¨ã¤ã«ã€‚ã‚ãªãŸã®æ¯æ—¥ã‚’è¦‹ãˆã‚‹åŒ–ã™ã‚‹å¤šæ©Ÿèƒ½ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚¢ãƒ—ãƒªã€‚</p>
    <header>
      <h2 id="monthYear"></h2>
      <div>
        <button onclick="changeMonth(-1)" class="button">â†</button>
        <button onclick="changeMonth(1)" class="button">â†’</button>
      </div>
    </header>

  <div id="homeGoalsSection">
    <h2>ç¾åœ¨ã®ç›®æ¨™</h2>
    <div id="goalContainer"></div>
    <div style="margin: 20px;">
      <a href="goals.html#add" class="button">â• ç›®æ¨™ã®è¿½åŠ </a>
      <a href="goals.html#list" class="button">ğŸ“ˆ é€²æ—ç®¡ç†</a>
      <a href="achieved-goals.html" class="button">âœ” é”æˆã—ãŸç›®æ¨™</a>
    </div>
  </div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const homeGoalsList = document.getElementById("homeGoalsList");
    const goals = JSON.parse(localStorage.getItem("goals") || "[]");

    if (goals.length === 0) {
      homeGoalsList.innerHTML = "<p>ç¾åœ¨ã€ç™»éŒ²ã•ã‚ŒãŸç›®æ¨™ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>";
      return;
    }

    goals.forEach(goal => {
      const div = document.createElement("div");
      div.className = "goal-card";
      div.style.marginBottom = "15px";

      if (goal.type === "quantitative") {
        const percent = Math.min((goal.currentProgress / goal.targetValue) * 100, 100);
        div.innerHTML = `
          <strong>${goal.title}</strong><br>
          <small>${goal.category} ï¼ é€²æ—: ${goal.currentProgress}/${goal.targetValue}${goal.targetType}</small>
          <div style="background:#eee; height:10px; border-radius:5px; overflow:hidden; margin-top:5px;">
            <div style="width:${percent}%; height:100%; background:#2ecc71;"></div>
          </div>
          <button class="button" onclick="editGoal(${goal.id})">ç·¨é›†</button>
          <button class="delete" onclick="deleteGoal(${goal.id})">å‰Šé™¤</button>
        `;
      } else if (goal.type === "checklist") {
        const done = goal.items.filter(item => item.done).length;
        const percent = Math.min((done / goal.items.length) * 100, 100);
        div.innerHTML = `
          <strong>${goal.title}</strong><br>
          <small>${goal.category} ï¼ ãƒã‚§ãƒƒã‚¯: ${done}/${goal.items.length}</small>
          <div style="background:#eee; height:10px; border-radius:5px; overflow:hidden; margin-top:5px;">
            <div style="width:${percent}%; height:100%; background:#f39c12;"></div>
          </div>
          <button class="button" onclick="editGoal(${goal.id})">ç·¨é›†</button>
          <button class="delete" onclick="deleteGoal(${goal.id})">å‰Šé™¤</button>
        `;
      } else if (goal.type === "free") {
        const status = goal.status === "é”æˆ" ? "âœ” é”æˆæ¸ˆã¿" : "â³ æœªé”æˆ";
        div.innerHTML = `
          <strong>${goal.title}</strong><br>
          <small>${goal.category} ï¼ çŠ¶æ…‹: ${status}</small>
          <button class="button" onclick="editGoal(${goal.id})">ç·¨é›†</button>
          <button class="delete" onclick="deleteGoal(${goal.id})">å‰Šé™¤</button>
        `;
      }
    });
  });

  function editGoal(id) {
    window.location.href = `goals.html#edit-${id}`;
  }

  function deleteGoal(id) {
    if (!confirm("æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")) return;
    let goals = JSON.parse(localStorage.getItem("goals") || "[]");
    goals = goals.filter(g => g.id !== id);
    localStorage.setItem("goals", JSON.stringify(goals));
    location.reload();
  }
</script>

    <div id="aiSearchSection">
      <h2>AIäºˆå®šæ¤œç´¢</h2>
      <input type="text" id="aiQuery" placeholder="ä¾‹ï¼šåŸ¼ç‰çœŒã®å¤ç¥­ã‚Šã®æ—¥ç¨‹">
      <button onclick="searchWithAI()" class="button">æ¤œç´¢</button>
      <div id="aiResults"></div>
    </div>

    <div style="margin: 20px 0;">
      <a href="diary-list.html" class="button">ğŸ“– æ—¥è¨˜ä¸€è¦§ã‚’è¦‹ã‚‹</a>
    </div>

    <div style="margin: 20px 0";>
      <a href="lifestyle-dashboard.html" class="button">ğŸ“Š ç”Ÿæ´»ç¿’æ…£ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</a>
    </div>

    <div>
      <button onclick="toggleDisplay('categorySettings')" class="button">ã‚«ãƒ†ã‚´ãƒªãƒ¼è¨­å®š</button>
      <button onclick="toggleDisplay('jobSettings')" class="button">ãƒã‚¤ãƒˆè¨­å®š</button>
    </div>

    <p id="salaryDisplay" style="margin: 10px 0; font-weight: bold;"></p>

    <div id="categorySettings" style="display: none;">
      <p>â€» ã‚«ãƒ†ã‚´ãƒªã¯æœ€å¤§10å€‹ã¾ã§è¨­å®šå¯èƒ½ã§ã™</p>
      <input type="text" id="newCategoryName" placeholder="ã‚«ãƒ†ã‚´ãƒªå">
      <select id="newCategoryColor">
        <option value="#1abc9c">ç·‘</option>
        <option value="#e67e22">ã‚ªãƒ¬ãƒ³ã‚¸</option>
        <option value="#34495e">ã‚°ãƒ¬ãƒ¼</option>
        <option value="#d35400">èµ¤èŒ¶</option>
        <option value="#8e44ad">ç´«</option>
      </select>
      <button onclick="addCategory(event)" class="button">è¿½åŠ </button>
      <ul id="categoryList"></ul>
    </div>

    <div id="jobSettings" style="display: none;">
      <input type="text" id="jobName" placeholder="ãƒã‚¤ãƒˆå">
      <input type="number" id="jobWage" placeholder="æ™‚çµ¦ (å††)" min="0">
      <input type="number" id="jobUnit" placeholder="ä½•åˆ†å˜ä½ (ä¾‹: 15)" min="1">
      <button onclick="addJob()" class="button">è¿½åŠ </button>
      <ul id="jobList"></ul>
    </div>

    <table>
      <thead>
        <tr>
          <th>æ—¥</th><th>æœˆ</th><th>ç«</th><th>æ°´</th><th>æœ¨</th><th>é‡‘</th><th>åœŸ</th>
        </tr>
      </thead>
      <tbody id="calendar-body"></tbody>
    </table>

    <div id="eventForm" style="display:none;">
      <h2 id="selectedDate">äºˆå®šè¿½åŠ </h2>
      <select id="eventCategory" onchange="toggleJobSelect()"></select>
      <select id="jobSelector" style="display:none;"></select>
      <input type="text" id="eventTitle" placeholder="ã‚¿ã‚¤ãƒˆãƒ«">
      <input type="time" id="eventStart">
      <input type="time" id="eventEnd">
      <textarea id="eventMemo" placeholder="ãƒ¡ãƒ¢ï¼ˆä»»æ„ï¼‰"></textarea>
      <button onclick="saveEvent()" class="button">ä¿å­˜</button>
      <button onclick="closeEventForm()" class="button">é–‰ã˜ã‚‹</button>
    </div>

    <div id="diaryForm" style="display:none;">
      <h2 id="selectedDiaryDate">æ—¥è¨˜å…¥åŠ›</h2>
      <input type="text" id="breakfast" placeholder="æœé£Ÿ">
      <input type="text" id="lunch" placeholder="æ˜¼é£Ÿ">
      <input type="text" id="dinner" placeholder="å¤•é£Ÿ">
      <input type="time" id="wakeUp" placeholder="èµ·åºŠæ™‚é–“">
      <input type="time" id="sleep" placeholder="å°±å¯æ™‚é–“">
      <input type="number" id="exercise" placeholder="é‹å‹•æ™‚é–“ï¼ˆåˆ†ï¼‰">
      <textarea id="notes" placeholder="æ´»å‹•è¨˜éŒ²"></textarea>
      <button onclick="saveDiary()" class="button">ä¿å­˜</button>
      <button onclick="closeDiaryForm()" class="button">é–‰ã˜ã‚‹</button>
    </div>
  </div>

  <script>
    function toggleDisplay(id) {
      const elem = document.getElementById(id);
      elem.style.display = (elem.style.display === "none") ? "block" : "none";
    }
  </script>
  <script src="script.js"></script>
  <script src="goals-index.js"></script>
</body>
</html>
